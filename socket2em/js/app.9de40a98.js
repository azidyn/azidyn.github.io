(function(t){function e(e){for(var s,o,a=e[0],c=e[1],u=e[2],h=0,d=[];h<a.length;h++)o=a[h],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&d.push(n[o][0]),n[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);l&&l(e);while(d.length)d.shift()();return r.push.apply(r,u||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],s=!0,a=1;a<i.length;a++){var c=i[a];0!==n[c]&&(s=!1)}s&&(r.splice(e--,1),t=o(o.s=i[0]))}return t}var s={},n={app:0},r=[];function o(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=s,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(i,s,function(e){return t[e]}.bind(null,s));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var l=c;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";i("85ec")},"36b3":function(t,e,i){(function(e,s){i("99af"),i("caad"),i("ac1f"),i("2532"),i("1276");var n,r,o=i("6374"),a=i("970b"),c=i("5bc3"),u=i("6b58"),l=i("3c96"),h=i("ed6d"),d=i("2d0d"),b=i("3e8f"),f=i("5421"),v=i("d97e"),p=i("6fce"),y=i("87df"),k=i("384c"),g="wss://stream.bybit.com/realtime_public",m=null,_=[];null!=m&&setTimeout((function(){b.writeFileSync(m,JSON.stringify(_)),e.exit()}),1e4);var w=function(t){"use strict";h(b,t);var i=d(b);function b(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(this,b),t=i.call(this),t.opts=e,t.connected=!1,t.library=new v,t.trade=new k({exchange:"bybit",sizetoquote:!0,aggregate:!0}),t.opts.simulate?(console.log("Running simulation"),p.run("".concat(s,"/btcusdt-linear-l2-replay.json"),t.opts.simulate,t.delegate.bind(l(t))),u(t)):(t.subs={},t.ws=new f,t.ws.onopen=function(){for(var e in t.connected=!0,t.subs){var i,s=t.subs[e],n=o(s);try{for(n.s();!(i=n.n()).done;){var r=i.value;t.listen(t.fmt(e,r))}}catch(a){n.e(a)}finally{n.f()}}},t.ws.onclose=function(){t.connected=!1},t.ws.onmessage=function(e){null!=m&&_.push(e),t.delegate(e)},t)}return c(b,[{key:"orderbook",value:function(t){this.subscribe(t,"orderBook_200.100ms")}},{key:"trades",value:function(t){this.subscribe(t,"trade")}},{key:"stop",value:function(t,e){}},{key:"subscribe",value:function(t,e){if(!this.opts.simulate){this.subs[t]=this.subs[t]||[];var i=this.subs[t];i.includes(e)||(this.subs[t].push(e),this.listen(this.fmt(t,e)))}}},{key:"listen",value:function(t){this.opts.simulate||this.connected&&this.ws.send(JSON.stringify(t))}},{key:"connect",value:function(){this.opts.simulate||this.ws.open(g)}},{key:"fmt",value:function(t,e){return{op:"subscribe",args:["".concat(e,".").concat(t)]}}},{key:"delegate",value:function(t){if(null==m&&(n=JSON.parse(t),n.topic)){try{r=n.topic.split(".")}catch(i){console.log(i),e.exit()}switch(r[0]){case"orderBook_200":this.fire("orderbook",this.library.handle(n,r[2]));break;case"trade":this.fire("trades",this.trade.handle(n.data));break}}}}]),b}(y);t.exports=w}).call(this,i("4362"),"/")},"384c":function(t,e,i){i("d81d"),i("a9e3");var s=i("6374"),n=i("970b"),r=i("5bc3"),o={Buy:"buy",Sell:"sell"},a=function(){"use strict";function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,t),this.aggregate=e.aggregate,this.exchange=e.exchange||"bybit",this.sizetoquote=e.sizetoquote||!1}return r(t,[{key:"handle",value:function(t){var e=this;return this.aggregate?this.agg(t):t.map((function(t){return{timestamp:Number(t.trade_time_ms),exchange:e.exchange,symbol:t.symbol,side:o[t.side],price:Number(t.price),size:e.sizetoquote?Mathr.round(Number(t.size)*Number(t.price)):Number(t.size),sizecoin:Number(t.size)}}))}},{key:"agg",value:function(t){var e,i=[],n="",r=0,a=0,c="",u="",l=s(t);try{for(l.s();!(e=l.n()).done;){var h=e.value;h.trade_time_ms!=n||h.side!=c||h.symbol!=u?(a&&i.push({aggregate:!0,timestamp:n,exchange:this.exchange,symbol:u,side:o[c],price:r,size:this.sizetoquote?Math.round(a*r):a,sizecoin:a}),n=Number(h.trade_time_ms),a=Number(h.size),r=Number(h.price),c=h.side,u=h.symbol):a+=Number(h.size)}}catch(d){l.e(d)}finally{l.f()}return a&&i.push({aggregate:!0,timestamp:n,exchange:this.exchange,symbol:u,side:o[c],price:r,size:this.sizetoquote?Math.round(a*r):a,sizecoin:a}),i}}]),t}();t.exports=a},"406a":function(t,e,i){i("d81d");var s=i("6374"),n=i("970b"),r=i("5bc3"),o={Buy:"buy",Sell:"sell"},a=function(){"use strict";function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,t),this.aggregate=e.aggregate}return r(t,[{key:"handle",value:function(t){return this.aggregate?this.agg(t):t.map((function(t){return{timestamp:Date.parse(t.timestamp),exchange:"bitmex",symbol:t.symbol,side:o[t.side],price:t.price,size:t.size}}))}},{key:"agg",value:function(t){var e,i=[],n="",r=0,a=0,c="",u="",l=s(t);try{for(l.s();!(e=l.n()).done;){var h=e.value;h.timestamp!=n||h.side!=c||h.symbol!=u?(a&&i.push({aggregate:!0,timestamp:Date.parse(n),exchange:"bitmex",symbol:u,side:o[c],price:r,size:a}),n=h.timestamp,a=h.size,r=h.price,c=h.side,u=h.symbol):a+=h.size}}catch(d){l.e(d)}finally{l.f()}return a&&i.push({aggregate:!0,timestamp:Date.parse(n),exchange:"bitmex",symbol:u,side:o[c],price:r,size:a}),i}}]),t}();t.exports=a},"4c26":function(t,e,i){i("4ec9"),i("d3b7"),i("3ca3"),i("ddb0");var s=i("6374"),n=i("970b"),r=i("5bc3"),o=(buggerit(!0),i("eadd")),a=function(){"use strict";function t(){n(this,t),this.id=new Map,this.lob=new o}return r(t,[{key:"insert",value:function(t){var e,i,n=s(t);try{for(n.s();!(i=n.n()).done;)e=i.value,this.id.set(e.id,e.price),"Buy"==e.side?this.lob.bid(e.price,e.size):this.lob.ask(e.price,e.size)}catch(r){n.e(r)}finally{n.f()}}},{key:"update",value:function(t){var e,i,n,r=s(t);try{for(r.s();!(n=r.n()).done;)e=n.value,i=this.id.get(e.id),i&&("Buy"==e.side?this.lob.bid(i,e.size):this.lob.ask(i,e.size))}catch(o){r.e(o)}finally{r.f()}}},{key:"delete",value:function(t){var e,i,n,r=s(t);try{for(r.s();!(n=r.n()).done;)e=n.value,i=this.id.get(e.id),i&&("Buy"==e.side?this.lob.bid(i,0):this.lob.ask(i,0))}catch(o){r.e(o)}finally{r.f()}}}]),t}();t.exports=a},5421:function(t,e,i){var s=i("149a"),n=5,r=90,o=null,a=null;function c(t,e){this.number=0,this.autoReconnectInterval=5e3,this.reconnectDuration=e||n,this.heartbeatDuration=t||r}c.prototype.resetHeartbeat=function(){var t=this;a&&clearTimeout(a),a=setTimeout((function(){console.log("\n[WSC] connection stale, sending ping..."),t.instance.send("ping"),o=setTimeout((function(){return t.reconnect()}),1e3*t.reconnectDuration)}),1e3*this.heartbeatDuration)},c.prototype.open=function(t){var e=this;this.url=t,this.instance=new s(this.url),this.instance.onopen=function(){e.onopen()},this.instance.onmessage=function(t,i){if(e.number++,"pong"==t.data)return console.log("pong heartbeat received - cancelling reconnect"),void(o&&clearTimeout(o));e.resetHeartbeat(),e.onmessage(t.data,i,e.number)},this.instance.onclose=function(t){switch(t.code){case 1e3:console.log("WebSocket: closed");break;default:e.reconnect(t);break}e.onclose(t)},this.instance.onerror=function(t){switch(t.code){case"ECONNREFUSED":e.reconnect(t);break;default:e.onerror(t);break}}},c.prototype.send=function(t,e){try{this.instance.send(t,e)}catch(i){this.instance.emit("error",i)}},c.prototype.reconnect=function(t){console.log("[WSC] retry in ".concat(this.autoReconnectInterval,"ms")),this.instance.removeAllListeners();var e=this;setTimeout((function(){console.log("[WSC] reconnecting..."),e.open(e.url)}),this.autoReconnectInterval)},c.prototype.onopen=function(t){console.log("[WSC] open",arguments)},c.prototype.onmessage=function(t,e,i){console.log("[WSC] message",arguments)},c.prototype.onerror=function(t){console.log("[WSC] error",arguments)},c.prototype.onclose=function(t){console.log("[WSC] closed",arguments)},t.exports=c},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var s=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[t._m(0),i("div",{staticClass:"row m-1"},[i("div",{staticClass:"col"},[i("table",[t._l(this.lob.bitmex.eth.asks,(function(e){return i("tr",{key:e[0],staticStyle:{"background-color":"#fdd"}},[i("td",[t._v(t._s(e[0]))]),i("td",[t._v(t._s(e[1])+" ")])])})),t._m(1),t._l(this.lob.bitmex.eth.bids,(function(e){return i("tr",{key:e[0],staticStyle:{"background-color":"#dfd"}},[i("td",[t._v(t._s(e[0]))]),i("td",[t._v(t._s(e[1])+" ")])])}))],2)]),i("div",{staticClass:"col"},[i("table",[t._l(this.lob.bitmex.xbt.asks,(function(e){return i("tr",{key:e[0],staticStyle:{"background-color":"#fdd"}},[i("td",[t._v(t._s(e[0]))]),i("td",[t._v(t._s(e[1])+" ")])])})),t._m(2),t._l(this.lob.bitmex.xbt.bids,(function(e){return i("tr",{key:e[0],staticStyle:{"background-color":"#dfd"}},[i("td",[t._v(t._s(e[0]))]),i("td",[t._v(t._s(e[1])+" ")])])}))],2)]),i("div",{staticClass:"col"},[i("table",[t._l(this.lob.bybit.btc.asks,(function(e){return i("tr",{key:e[0],staticStyle:{"background-color":"#fdd"}},[i("td",[t._v(t._s(e[0]))]),i("td",[t._v(t._s(e[1])+" ")])])})),t._m(3),t._l(this.lob.bybit.btc.bids,(function(e){return i("tr",{key:e[0],staticStyle:{"background-color":"#dfd"}},[i("td",[t._v(t._s(e[0]))]),i("td",[t._v(t._s(e[1])+" ")])])}))],2)]),i("div",{staticClass:"col"},[i("table",[t._l(this.lob.ibybit.btc.asks,(function(e){return i("tr",{key:e[0],staticStyle:{"background-color":"#fdd"}},[i("td",[t._v(t._s(e[0]))]),i("td",[t._v(t._s(e[1])+" ")])])})),t._m(4),t._l(this.lob.ibybit.btc.bids,(function(e){return i("tr",{key:e[0],staticStyle:{"background-color":"#dfd"}},[i("td",[t._v(t._s(e[0]))]),i("td",[t._v(t._s(e[1])+" ")])])}))],2)]),i("div",{staticClass:"col"},[i("table",{staticClass:"table"},[t._m(5),t._l(this.trades,(function(e){return i("tr",{key:e.id,style:"sell"==e.side?"background-color: #fdd":"background-color: #dfd"},[i("td",[t._v(t._s("sell"==e.side?"🔽":"🔼"))]),i("td",[t._v(t._s(e.exchange))]),i("td",[t._v(t._s(e.symbol))]),i("td",[t._v(t._s(e.price))]),i("td",[t._v(t._s(e.size))])])}))],2)])])])},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row"},[i("div",{staticClass:"col m-3"},[i("h3",[t._v("socket2em | realtime demo")]),i("a",{attrs:{href:"https://github.com/azidyn/socket2em"}},[t._v("https://github.com/azidyn/socket2em")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",[i("td",{staticStyle:{padding:"5px","font-weight":"bold"},attrs:{colspan:"2"}},[t._v("BitMEX:ETHUSD")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",[i("td",{staticStyle:{padding:"5px","font-weight":"bold"},attrs:{colspan:"2"}},[t._v("BitMEX:XBTUSD")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",[i("td",{staticStyle:{padding:"5px","font-weight":"bold"},attrs:{colspan:"2"}},[t._v("ByBit-Linear:BTCUSDT")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",[i("td",{staticStyle:{padding:"5px","font-weight":"bold"},attrs:{colspan:"2"}},[t._v("ByBit-Inverse:BTCUSD")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",[i("th"),i("th"),i("th"),i("th",[t._v("Price")]),i("th",[t._v("Size")])])}],o=(i("fb6a"),i("b85c"));i("88f9");var a=i("cf12"),c=i("36b3"),u=i("6d03"),l={name:"App",components:{},methods:{dotrades:function(t){var e,i=Object(o["a"])(t);try{for(i.s();!(e=i.n()).done;){var s=e.value;s.size>=this.minsizetrade&&(s.id=this.id++,this.trades2.push(s))}}catch(n){i.e(n)}finally{i.f()}this.trades=this.trades2.slice(-20).reverse(),this.trades2=this.trades2.slice(-20)}},data:function(){return{minsizetrade:5e3,id:0,trades:[],trades2:[],bitmex:null,bybit:null,lob:{bitmex:{eth:{bids:[],asks:[]},xbt:{bids:[],asks:[]}},bybit:{btc:{bids:[],asks:[]}},ibybit:{btc:{bids:[],asks:[]}}}}},mounted:function(){var t=this;this.bitmex=new a,this.bybit=new c,this.ibybit=new u,this.bitmex.orderbook("ETHUSD"),this.bitmex.orderbook("XBTUSD"),this.bybit.orderbook("BTCUSDT"),this.ibybit.orderbook("BTCUSD"),this.bitmex.trades("XBTUSD"),this.bybit.trades("BTCUSDT"),this.ibybit.trades("BTCUSD"),this.bitmex.connect(),this.bybit.connect(),this.ibybit.connect(),this.bitmex.on("trades",this.dotrades),this.bybit.on("trades",this.dotrades),this.ibybit.on("trades",this.dotrades),setInterval((function(){var e=t.bitmex.library.snapshot("ETHUSD",10),i=t.bitmex.library.snapshot("XBTUSD",10),s=t.bybit.library.snapshot("BTCUSDT",10),n=t.ibybit.library.snapshot("BTCUSD",10);e&&(t.lob.bitmex.eth.bids=e.bid,t.lob.bitmex.eth.asks=e.ask.reverse()),i&&(t.lob.bitmex.xbt.bids=i.bid,t.lob.bitmex.xbt.asks=i.ask.reverse()),s&&(t.lob.bybit.btc.bids=s.bid,t.lob.bybit.btc.asks=s.ask.reverse()),n&&(t.lob.ibybit.btc.bids=n.bid,t.lob.ibybit.btc.asks=n.ask.reverse())}),50)}},h=l,d=(i("034f"),i("2877")),b=Object(d["a"])(h,n,r,!1,null,null,null),f=b.exports;s["a"].config.productionTip=!1,new s["a"]({render:function(t){return t(f)}}).$mount("#app")},"5d02":function(t,e,i){i("7db0"),i("a434");var s=i("970b"),n=i("5bc3"),r=function(){"use strict";function t(){s(this,t),this.ticks=[],this.head=0,this.set=this.set_bids}return n(t,[{key:"peek",value:function(t){if(!this.ticks.length)return null;var e=this.find(t),i=this.ticks[e];return i[0]==t?i:null}},{key:"set_bids",value:function(t,e){if(!this.ticks.length)return this.ticks.push([t,e]),void(this.head=0);var i=this.find(t),s=this.ticks[this.head],n=this.ticks[i];if(n[0]==t)return n[1]=e,void(this.head==i&&0==e?(this.head=this._nz_scan(i-1),this.headcheck()):t>this.ticks[this.head][0]&&(this.head=i));var r=t>n[0],o=r?i+1:i;this.ticks.splice(o,0,[t,e]),r&&t>s[0]?(this.head=this._nz_scan(o),this.headcheck()):t<s[0]&&this.head++}},{key:"headcheck",value:function(){null==this.head&&(this.head=0,this.ticks=[])}},{key:"snapshot",value:function(t){var e=[];if(!this.ticks.length)return e;for(var i=this.head;i>=0;i--)if(this.ticks[i][1]>0&&e.push([this.ticks[i][0],this.ticks[i][1]]),e.length==t)break;return e}},{key:"find",value:function(t){var e=this.ticks,i=e.length;if(t<=e[0][0])return 0;if(t>=e[i-1][0])return i-1;var s=0,n=i,r=0;while(s<n){if(r=s+n>>1,e[r][0]==t)return r;if(t<e[r][0]){if(r>0&&t>e[r-1][0])return this._getClosest(r-1,r,t);n=r}else{if(r<i-1&&t<e[r+1][0])return this._getClosest(r,r+1,t);s=r+1}}}},{key:"_nz_scan",value:function(t){if(t<0)return 0;for(var e=t;e>=0;e--)if(this.ticks[e][1]>0)return e}},{key:"_getClosest",value:function(t,e,i){return i-this.ticks[t][0]>=this.ticks[e][0]-i?e:t}}]),t}();t.exports=r},"5e47":function(t,e,i){i("4de4");var s=i("970b"),n=i("5bc3"),r=i("4c26"),o=function(){"use strict";function t(){s(this,t),this.library={}}return n(t,[{key:"snapshot",value:function(t,e){if(this.library[t])return this.library[t].lob.snapshot(e)}},{key:"handle",value:function(t){var e=t.action;if("partial"==t.action){var i=new r;return this.library[t.filter.symbol]=i,this.process(t,"insert")}return this.process(t,e)}},{key:"process",value:function(t,e){if(t.data&&t.data.length){var i=t.data[0].symbol;if(this.library[i])return this.library[i][e](t.data),{instrument:i,orderbook:this.library[i].lob}}}}]),t}();t.exports=o},"6d03":function(t,e,i){(function(e,s){i("99af"),i("caad"),i("ac1f"),i("2532"),i("1276");var n,r,o=i("6374"),a=i("970b"),c=i("5bc3"),u=i("6b58"),l=i("3c96"),h=i("ed6d"),d=i("2d0d"),b=i("3e8f"),f=i("5421"),v=i("d97e"),p=i("6fce"),y=i("87df"),k=i("384c"),g="wss://stream.bybit.com/realtime",m=null,_=[];null!=m&&setTimeout((function(){b.writeFileSync(m,JSON.stringify(_)),e.exit()}),1e4);var w=function(t){"use strict";h(b,t);var i=d(b);function b(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(this,b),t=i.call(this),t.opts=e,t.connected=!1,t.library=new v,t.trade=new k({exchange:"ibybit",sizetoquote:!1,aggregate:!0}),t.opts.simulate?(console.log("Running simulation"),p.run("".concat(s,"/btcusd-l2-replay.json"),t.opts.simulate,t.delegate.bind(l(t))),u(t)):(t.subs={},t.ws=new f,t.ws.onopen=function(){for(var e in t.connected=!0,t.subs){var i,s=t.subs[e],n=o(s);try{for(n.s();!(i=n.n()).done;){var r=i.value;t.listen(t.fmt(e,r))}}catch(a){n.e(a)}finally{n.f()}}},t.ws.onclose=function(){t.connected=!1},t.ws.onmessage=function(e){null!=m&&_.push(e),t.delegate(e)},t)}return c(b,[{key:"trades",value:function(t){this.subscribe(t,"trade")}},{key:"orderbook",value:function(t){this.subscribe(t,"orderBook_200.100ms")}},{key:"stop",value:function(t,e){}},{key:"subscribe",value:function(t,e){if(!this.opts.simulate){this.subs[t]=this.subs[t]||[];var i=this.subs[t];i.includes(e)||(this.subs[t].push(e),this.listen(this.fmt(t,e)))}}},{key:"listen",value:function(t){this.opts.simulate||this.connected&&this.ws.send(JSON.stringify(t))}},{key:"connect",value:function(){this.opts.simulate||this.ws.open(g)}},{key:"fmt",value:function(t,e){return{op:"subscribe",args:["".concat(e,".").concat(t)]}}},{key:"delegate",value:function(t){if(null==m&&(n=JSON.parse(t),n.topic)){try{r=n.topic.split(".")}catch(i){console.log(i),e.exit()}switch(r[0]){case"orderBook_200":this.fire("orderbook",this.library.handle(n,r[2]));break;default:this.fire("trades",this.trade.handle(n.data));break}}}}]),b}(y);t.exports=w}).call(this,i("4362"),"/")},"6fce":function(t,e,i){var s=i("6374"),n=null,r=0;t.exports={run:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("path: ",t);var a=i("7b2c")(t);if(0!=e){if(n)return;n=setInterval((function(){o(a[r++]),r>=a.length&&clearInterval(n)}),e)}else if(o){var c,u=s(a);try{for(u.s();!(c=u.n()).done;){var l=c.value;o(l)}}catch(h){u.e(h)}finally{u.f()}}}}},"7b2c":function(t,e){function i(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}i.keys=function(){return[]},i.resolve=i,t.exports=i,i.id="7b2c"},"85ec":function(t,e,i){},"87df":function(t,e,i){i("4160"),i("4ec9"),i("d3b7"),i("3ca3"),i("159b"),i("ddb0");var s=i("970b"),n=i("5bc3"),r=function(){"use strict";function t(){s(this,t),this.listeners=new Map,this.on=this.addListener,this.fire=this.emit}return n(t,[{key:"addListener",value:function(t,e){this.listeners.has(t)||this.listeners.set(t,[]),this.listeners.get(t).push(e)}},{key:"_isFunction",value:function(t){return"function"==typeof t||!1}},{key:"clearListeners",value:function(t){this.listeners.set(t,[])}},{key:"removeListener",value:function(){throw"Unimplemented"}},{key:"emit",value:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];var n=this.listeners.get(t);return!(!n||!n.length)&&(n.forEach((function(t){t.apply(void 0,i)})),!0)}}]),t}();t.exports=r},"88f9":function(t,e,i){(function(t){var e=function(t){var e=t;return function(t){e&&console.log(t)}};"undefined"!==typeof window?window.buggerit=e:t.buggerit=e}).call(this,i("c8ba"))},cae6:function(t,e,i){i("4ec9"),i("a9e3"),i("d3b7"),i("3ca3"),i("ddb0");var s=i("6374"),n=i("970b"),r=i("5bc3"),o=(buggerit(!0),i("eadd")),a=function(){"use strict";function t(){n(this,t),this.id=new Map,this.lob=new o}return r(t,[{key:"insert",value:function(t){var e,i,n,r,o=s(t);try{for(o.s();!(r=o.n()).done;)e=r.value,i=Number(e.price),n=Number(e.size),"Buy"==e.side?this.lob.bid(i,n):this.lob.ask(i,n)}catch(a){o.e(a)}finally{o.f()}}},{key:"update",value:function(t){var e,i,n,r,o=s(t);try{for(o.s();!(r=o.n()).done;)e=r.value,i=Number(e.price),n=Number(e.size),"Buy"==e.side?this.lob.bid(i,n):this.lob.ask(i,n)}catch(a){o.e(a)}finally{o.f()}}},{key:"delete",value:function(t){var e,i,n,r=s(t);try{for(r.s();!(n=r.n()).done;)e=n.value,i=Number(e.price),"Buy"==e.side?this.lob.bid(i,0):this.lob.ask(i,0)}catch(o){r.e(o)}finally{r.f()}}}]),t}();t.exports=a},cf12:function(t,e,i){(function(e){i("99af"),i("caad"),i("2532");var s,n=i("6374"),r=i("970b"),o=i("5bc3"),a=i("6b58"),c=i("3c96"),u=i("ed6d"),l=i("2d0d"),h=i("6fce"),d=i("3e8f"),b=i("5421"),f=i("5e47"),v=i("87df"),p=i("406a"),y=i("4362"),k=(y.traceDeprecation,"wss://www.bitmex.com/realtime"),g=null,m=[];null!=g&&setTimeout((function(){d.writeFileSync(g,JSON.stringify(m)),e.exit()}),1e4);var _=function(t){"use strict";u(i,t);var e=l(i);function i(){var t,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,i),t=e.call(this),t.opts=s,t.connected=!1,t.library=new f,t.trade=new p({aggregate:!1}),t.opts.simulate?(console.log("Running simulation"),h.run(t.opts.simulate,t.delegate.bind(c(t))),a(t)):(t.subs={},t.ws=new b,t.ws.onopen=function(){for(var e in t.connected=!0,t.subs){var i,s=t.subs[e],r=n(s);try{for(r.s();!(i=r.n()).done;){var o=i.value;t.listen(t.fmt(e,o))}}catch(a){r.e(a)}finally{r.f()}}},t.ws.onclose=function(){t.connected=!1},t.ws.onmessage=function(e){null!=g&&m.push(e),t.delegate(e)},t)}return o(i,[{key:"trades",value:function(t){this.subscribe(t,"trade")}},{key:"orderbook",value:function(t){this.subscribe(t,"orderBookL2")}},{key:"stop",value:function(t,e){}},{key:"subscribe",value:function(t,e){if(!this.opts.simulate){this.subs[t]=this.subs[t]||[];var i=this.subs[t];i.includes(e)||(this.subs[t].push(e),this.listen(this.fmt(t,e)))}}},{key:"listen",value:function(t){this.opts.simulate||this.connected&&this.ws.send(JSON.stringify(t))}},{key:"connect",value:function(){this.opts.simulate||this.ws.open(k)}},{key:"fmt",value:function(t,e){return{op:"subscribe",args:["".concat(e,":").concat(t)]}}},{key:"delegate",value:function(t){if(null==g)switch(s=JSON.parse(t),s.table){case"orderBookL2":this.fire("orderbook",this.library.handle(s));break;case"trade":this.fire("trades",this.trade.handle(s.data));break}}}]),i}(v);t.exports=_}).call(this,i("4362"))},d97e:function(t,e,i){var s=i("970b"),n=i("5bc3"),r=i("cae6"),o=function(){"use strict";function t(){s(this,t),this.library={}}return n(t,[{key:"snapshot",value:function(t,e){if(this.library[t])return this.library[t].lob.snapshot(e)}},{key:"handle",value:function(t,e){if("snapshot"==t.type){var i=new r;return this.library[e]=i,this.process(e,t.data,"init")}return this.process(e,t.data,"delta")}},{key:"process",value:function(t,e,i){var s=this.library[t];if(s)return"init"==i?s.insert(e.order_book||e):(e.delete.length&&s.delete(e.delete),e.update.length&&s.update(e.update),e.insert.length&&s.insert(e.insert)),{instrument:t,orderbook:s.lob}}}]),t}();t.exports=o},de15:function(t,e,i){i("7db0"),i("a434");var s=i("970b"),n=i("5bc3"),r=function(){"use strict";function t(){s(this,t),this.ticks=[],this.head=0,this.set=this.set_asks}return n(t,[{key:"peek",value:function(t){if(!this.ticks.length)return null;var e=this.find(t),i=this.ticks[e];return i[0]==t?i:null}},{key:"set_asks",value:function(t,e){if(!this.ticks.length)return this.ticks.push([t,e]),void(this.head=0);var i=this.find(t),s=this.ticks[this.head],n=this.ticks[i];if(n[0]==t)return n[1]=e,void(this.head==i&&0==e?(this.head=this._nz_scan(i+1),this.headcheck()):t<this.ticks[this.head][0]&&(this.head=i));var r=t<n[0],o=r?i:i+1;this.ticks.splice(o,0,[t,e]),r&&t<s[0]&&(this.head=this._nz_scan(o),this.headcheck())}},{key:"headcheck",value:function(){null==this.head&&(this.head=0,this.ticks=[])}},{key:"snapshot",value:function(t){var e=[];if(!this.ticks.length)return e;for(var i=this.head;i<this.ticks.length;i++)if(this.ticks[i][1]>0&&e.push([this.ticks[i][0],this.ticks[i][1]]),e.length==t)break;return e}},{key:"find",value:function(t){var e=this.ticks,i=e.length;if(t<=e[0][0])return 0;if(t>=e[i-1][0])return i-1;var s=0,n=i,r=0;while(s<n){if(r=s+n>>1,e[r][0]==t)return r;if(t<e[r][0]){if(r>0&&t>e[r-1][0])return this._getClosest(r-1,r,t);n=r}else{if(r<i-1&&t<e[r+1][0])return this._getClosest(r,r+1,t);s=r+1}}}},{key:"_nz_scan",value:function(t){for(var e=t;e<this.ticks.length;e++)if(this.ticks[e][1]>0)return e}},{key:"_getClosest",value:function(t,e,i){return i-this.ticks[t][0]>=this.ticks[e][0]-i?e:t}}]),t}();t.exports=r},eadd:function(t,e,i){var s=i("970b"),n=i("5bc3"),r=i("5d02"),o=i("de15"),a=function(){"use strict";function t(){s(this,t),this.bids=new r,this.asks=new o}return n(t,[{key:"bid",value:function(t,e){this.bids.set(t,e)}},{key:"ask",value:function(t,e){this.asks.set(t,e)}},{key:"peek",value:function(t,e){return"ask"==t?this.asks.peek(e):this.bids.peek(e)}},{key:"snapshot",value:function(t){return{bid:this.bids.snapshot(t),ask:this.asks.snapshot(t)}}}]),t}();t.exports=a}});